parameters:
  EmulatorInstallPath: "$(Agent.HomeDirectory)/../../Program Files/Azure Cosmos DB Emulator/Microsoft.Azure.Cosmos.Emulator.exe"
  EmulatorMsiUrl: "https://aka.ms/cosmosdbemulator-internal"
  StartParameters: '/noexplorer /noui /enablepreview /EnableSqlComputeEndpoint /disableratelimiting /partitioncount=10 /consistency=Strong /overrides=queryEnableFullText:true;'

steps:
  - task: Powershell@2
    inputs:
      filePath: $(Build.SourcesDirectory)/templates/Cosmos-Emulator.ps1
      arguments: >
        -EmulatorMsiUrl "${{ parameters.EmulatorMsiUrl }}"
        -StartParameters "${{ parameters.StartParameters }}"
        -Emulator "${{ parameters.EmulatorInstallPath }}"
        -Stage "Launch"
      pwsh: true
    displayName: Launch Public Cosmos DB Emulator